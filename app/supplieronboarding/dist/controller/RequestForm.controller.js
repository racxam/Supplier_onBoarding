sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/Icon","sap/m/Link","sap/ui/model/json/JSONModel","sap/ui/core/Fragment","sap/m/Dialog","sap/m/Button","sap/m/Text"],function(e,t,a,r,s,i,o,l,n){"use strict";return e.extend("com.sumo.supplieronboarding.controller.RequestForm",{onInit:function(){var e=new sap.ui.model.json.JSONModel({documentfiles:[]});this.getView().setModel(e);this.onReadSupplierSpendType();this.onReadNatureofActivity();this.onReadSector();this.onReadDepartments();var t=new Date;var a=new Date;a.setFullYear(t.getFullYear()+4);var r=this.byId("datePicker");r.setMinDate(t);r.setMaxDate(a);var e=new sap.ui.model.json.JSONModel({panCardValue:"",gstinValue:"",emailValue:"",numberValue:"",pan:[],gst:[]});this.getView().setModel(e)},onPanCardChange:function(e){var t=e.getSource();var a=t.getValue().toUpperCase();a=a.replace(/[^A-Z0-9]/g,"");t.setValue(a);if(this._panCardDebounceTimeout){clearTimeout(this._panCardDebounceTimeout)}this._panCardDebounceTimeout=setTimeout(function(){if(a.length===10){var e=/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/;if(e.test(a)){t.setValueState("Success");t.setValueStateText("")}else{t.setValueState("Error");t.setValueStateText("Invalid PAN format. It should be 5 letters, 4 numbers, and 1 letter.")}}else{t.setValueState("Error");t.setValueStateText("PAN must be exactly 10 characters long.")}},1e3)},onGSTINChange:function(e){var t=e.getSource();var a=t.getValue().toUpperCase();a=a.replace(/[^A-Z0-9]/g,"");t.setValue(a);var r=this.getView().getModel().getProperty("/panCardValue");if(this._gstinDebounceTimeout){clearTimeout(this._gstinDebounceTimeout)}this._gstinDebounceTimeout=setTimeout(function(){if(a.length===15){var e=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;if(e.test(a)){var s=a.substring(2,12);if(s===r){t.setValueState("Success");t.setValueStateText("")}else{t.setValueState("Error");t.setValueStateText("The PAN part of the GSTIN does not match the entered PAN.")}}else{t.setValueState("Error");t.setValueStateText("Invalid GSTIN format. It should be 15 characters long with the correct structure.")}}else{t.setValueState("Error");t.setValueStateText("GSTIN must be exactly 15 characters long.")}},1e3)},onSubmitpan:function(){var e=this.byId("panInput");var a=e.getValue();if(e.getValueState()==="Success"){t.show("PAN Card number is valid: "+a)}else{t.show("Please enter a valid PAN Card number.")}},onSubmitgst:function(){var e=this.getView().byId("gstinInput").getValue();if(e){this.verifyGST(e)}else{a.error("Please enter a valid GSTIN.")}},verifyGST:function(e){var t=this.getView().getModel("V4odataService");t.bindContext("/getStatus()",{urlParameters:{gstin:e}}).requestObject().then(function(e){this._onpopulate(e);console.log("API data:",e)}.bind(this)).catch(function(e){console.error("Error calling backend API:",e);a.error("Error fetching GST details. Please try again.")}.bind(this))},_onpopulate:function(e){this.getView().byId("SupplierNameInput").setValue(e.value.data.lgnm);this.getView().byId("SuppliertradeNameInput").setValue(e.value.data.tradeNam)},onEmailChange:function(e){var t=e.getSource();var a=t.getValue();a=a.replace(/\s+/g,"");t.setValue(a);if(this._emailDebounceTimeout){clearTimeout(this._emailDebounceTimeout)}this._emailDebounceTimeout=setTimeout(function(){var e=/^[a-zA-Z0-9]+(?:\.[a-zA-Z0-9]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])$/;if(a===""||!e.test(a)){t.setValueState("Error");t.setValueStateText("Invalid Email format. Please enter a valid Email.")}else{t.setValueState("Success")}},1e3)},onSubmitemail:function(){var e=this.byId("emailInput");var a=e.getValue();if(e.getValueState()==="Success"){t.show("Email is valid: "+a)}else{t.show("Please enter a valid email address.")}},onNumberChange:function(e){var t=e.getSource();var a=t.getValue();a=a.replace(/\D/g,"");if(a.length>10){a=a.substring(0,10)}t.setValue(a);if(this._numberDebounceTimeout){clearTimeout(this._numberDebounceTimeout)}this._numberDebounceTimeout=setTimeout(function(){if(a.length===10){t.setValueState("Success")}else{t.setValueState("Error");t.setValueStateText("Invalid Number. Please enter a valid Mobile Number.")}},1e3)},onSubmitnumber:function(){var e=this.byId("numberInput");var a=e.getValue();if(e.getValueState()==="Success"){t.show("Number is valid: "+a)}else{t.show("Please enter a valid Mobile number.")}},onDownload:function(e){var t=e.getSource();var a=t.getCustomData()[0].getValue();var r=t.getText();var s=document.createElement("a");s.href=a;s.download=r;document.body.appendChild(s);s.click();document.body.removeChild(s)},onDeleteFilepan:function(e){var a=e.getSource();var r=a.getParent().getParent();var s=this.getView().getModel();var i=s.getProperty("/pan");var o=r.getBindingContext().getPath().split("/").pop();i.splice(o,1);s.setProperty("/pan",i);t.show("File deleted successfully.")},onDeleteFilegst:function(e){var a=e.getSource();var r=a.getParent().getParent();var s=this.getView().getModel();var i=s.getProperty("/gst");var o=r.getBindingContext().getPath().split("/").pop();i.splice(o,1);s.setProperty("/gst",i);t.show("File deleted successfully.")},onFileUploadpan:function(e){var a=e.getSource();var r=a.oFileUpload.files[0];if(r){var s=r.name;var i=new FileReader;var o=this;i.onload=function(e){var a=e.target.result;var r=o.getView().getModel();var i=r.getProperty("/pan");i.push({fileName:s,fileUrl:a});r.setProperty("/pan",i);console.log("Updated /Pan attachment:",r.getProperty("/pan"));t.show("File "+s+" uploaded successfully.");r.refresh(true)};i.readAsDataURL(r)}},formatAttachmentButtonTextpan:function(e){if(e&&e.length>0){return"View Attachments ("+e.length+")"}else{return"View Attachments (0)"}},onOpenDialogpan:function(){if(!this._oPanDialog){this._oPanDialog=this.getView().byId("panDialog");if(!this._oPanDialog){this._oPanDialog=sap.ui.xmlfragment("com.sumo.supplieronboarding.view.fragment.uploadfile",this);this.getView().addDependent(this._oPanDialog)}}this._oPanDialog.open()},onCloseDialogpan:function(){if(this._oPanDialog){this._oPanDialog.close()}},onFormsubmit:function(){var e=this.getView();var a=this.getOwnerComponent().getModel();var r=true;var s={panattachment:e.byId("fileUploaderPan").getValue(),gstattachment:e.byId("fileUploaderGst").getValue()};var i={validity:e.byId("datePicker").getValue(),relatedParty:e.byId("radioGroup").getSelectedButton(),supplierSpendType:e.byId("supplierSpendType").getSelectedKey(),natureOfActivity:e.byId("NatureofActivity").getSelectedKey(),sector:e.byId("sectorComboBox").getSelectedKeys(),FunctionandSubfunction:e.byId("childMultiComboBox").getSelectedKeys(),panCardNumber:e.byId("panInput").getValue(),gstinNumber:e.byId("gstinInput").getValue(),supplierFullName:e.byId("SupplierNameInput").getValue(),supplierTradeName:e.byId("SuppliertradeNameInput").getValue(),supplierAddress:e.byId("SupplierAddressInput").getValue(),supplierGstAddress:e.byId("SupplierAddressgstInput").getValue(),primaryFirstName:e.byId("PrimaryFirstnameInput").getValue(),primaryLastName:e.byId("PrimaryLastnameInput").getValue(),primaryEmail:e.byId("emailInput").getValue(),primaryPhone:e.byId("numberInput").getValue()};if(!i.validity){e.byId("datePicker").setValueState(sap.ui.core.ValueState.Error).setValueStateText("Date is required");r=false}else{e.byId("datePicker").setValueState(sap.ui.core.ValueState.None)}if(i.supplierSpendType.length===0){e.byId("supplierSpendType").setValueState(sap.ui.core.ValueState.Error).setValueStateText("Supplier Spend Type is required");r=false}else{e.byId("supplierSpendType").setValueState(sap.ui.core.ValueState.None)}if(i.natureOfActivity.length===0){e.byId("NatureofActivity").setValueState(sap.ui.core.ValueState.Error).setValueStateText("Nature of Activity is required");r=false}else{e.byId("NatureofActivity").setValueState(sap.ui.core.ValueState.None)}if(i.sector.length===0){e.byId("sectorComboBox").setValueState(sap.ui.core.ValueState.Error).setValueStateText("At least one sector is required.");r=false}else{e.byId("sectorComboBox").setValueState(sap.ui.core.ValueState.None)}if(i.FunctionandSubfunction.length===0){e.byId("childMultiComboBox").setValueState(sap.ui.core.ValueState.Error).setValueStateText("At least one function/subfunction is required.");r=false}else{e.byId("childMultiComboBox").setValueState(sap.ui.core.ValueState.None)}if(!i.panCardNumber||i.panCardNumber.trim()===""){e.byId("panInput").setValueState(sap.ui.core.ValueState.Error).setValueStateText("PAN Card Number is required");r=false}else{var o=i.panCardNumber.trim();var l=/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/;if(!l.test(o)){e.byId("panInput").setValueState(sap.ui.core.ValueState.Error).setValueStateText("Invalid PAN Card Number format. PAN should be in the format AAAAA9999A.");r=false}else{e.byId("panInput").setValueState(sap.ui.core.ValueState.None)}}if(!s.panattachment){e.byId("fileUploaderPan").setValueState(sap.ui.core.ValueState.Error).setValueStateText("PAN Card Attachment is required");r=false}else{e.byId("fileUploaderPan").setValueState(sap.ui.core.ValueState.None)}if(!s.gstattachment){e.byId("fileUploaderGst").setValueState(sap.ui.core.ValueState.Error).setValueStateText("PAN Card Attachment is required");r=false}else{e.byId("fileUploaderGst").setValueState(sap.ui.core.ValueState.None)}if(!i.gstinNumber||i.gstinNumber.trim()===""){var n=e.byId("gstinInput");if(n){n.setValueState(sap.ui.core.ValueState.Error).setValueStateText("GSTIN Number is required")}r=false}else{var u=i.gstinNumber.trim();var d=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[A-Z0-9]{1}[Z]{1}[0-9]{1}$/;if(!d.test(u)){var n=e.byId("gstinInput");if(n){n.setValueState(sap.ui.core.ValueState.Error).setValueStateText("Invalid GSTIN Number format. It should be in the format 12ABCDE3456Z1Z5.")}r=false}else{var n=e.byId("gstinInput");if(n){n.setValueState(sap.ui.core.ValueState.None)}var p=u.substring(2,12);var o=i.panCardNumber;if(p===o){n.setValueState(sap.ui.core.ValueState.Success);n.setValueStateText("")}else{n.setValueState(sap.ui.core.ValueState.Error);n.setValueStateText("The PAN part of the GSTIN does not match the entered PAN.");r=false}}}if(!i.supplierFullName||i.supplierFullName.trim()===""){e.byId("SupplierNameInput").setValueState(sap.ui.core.ValueState.Error);e.byId("SupplierNameInput").setValueStateText("Supplier Full Name is required and cannot be only spaces.");r=false}else{e.byId("SupplierNameInput").setValueState(sap.ui.core.ValueState.None)}if(!i.supplierTradeName||i.supplierTradeName.trim()===""){e.byId("SuppliertradeNameInput").setValueState(sap.ui.core.ValueState.Error);e.byId("SuppliertradeNameInput").setValueStateText("Supplier Trade Name is required and cannot be only spaces.");r=false}else{e.byId("SuppliertradeNameInput").setValueState(sap.ui.core.ValueState.None)}if(!i.supplierAddress||i.supplierAddress.trim()===""){e.byId("SupplierAddressInput").setValueState(sap.ui.core.ValueState.Error);e.byId("SupplierAddressInput").setValueStateText("Supplier Address is required and cannot be only spaces.");r=false}else{e.byId("SupplierAddressInput").setValueState(sap.ui.core.ValueState.None)}if(!i.supplierGstAddress||i.supplierGstAddress.trim()===""){e.byId("SupplierAddressgstInput").setValueState(sap.ui.core.ValueState.Error);e.byId("SupplierAddressgstInput").setValueStateText("Supplier GST Address is required and cannot be only spaces.");r=false}else{e.byId("SupplierAddressgstInput").setValueState(sap.ui.core.ValueState.None)}if(!i.primaryFirstName||i.primaryFirstName.trim()===""){e.byId("PrimaryFirstnameInput").setValueState(sap.ui.core.ValueState.Error);e.byId("PrimaryFirstnameInput").setValueStateText("Primary First Name is required and cannot be only spaces.");r=false}else{e.byId("PrimaryFirstnameInput").setValueState(sap.ui.core.ValueState.None)}if(!i.primaryLastName||i.primaryLastName.trim()===""){e.byId("PrimaryLastnameInput").setValueState(sap.ui.core.ValueState.Error);e.byId("PrimaryLastnameInput").setValueStateText("Primary Last Name is required and cannot be only spaces.");r=false}else{e.byId("PrimaryLastnameInput").setValueState(sap.ui.core.ValueState.None)}if(!i.primaryEmail||i.primaryEmail.trim()===""){e.byId("emailInput").setValueState(sap.ui.core.ValueState.Error).setValueStateText("Primary Email is required");r=false}else{var c=i.primaryEmail.trim().replace(/\s+/g,"");var m=/^[a-zA-Z0-9]+(?:\.[a-zA-Z0-9]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])$/;if(!m.test(c)){e.byId("emailInput").setValueState(sap.ui.core.ValueState.Error).setValueStateText("Invalid Primary Email format. Please enter a valid email.");r=false}else{e.byId("emailInput").setValueState(sap.ui.core.ValueState.None)}}if(!i.primaryPhone||i.primaryPhone.trim()===""){var g=e.byId("numberInput");if(g){g.setValueState(sap.ui.core.ValueState.Error).setValueStateText("Primary Phone Number is required")}r=false}else{var S=i.primaryPhone.trim();var f=/^[0-9]{10}$/;if(!f.test(S)){var g=e.byId("numberInput");if(g){g.setValueState(sap.ui.core.ValueState.Error).setValueStateText("Invalid Phone Number. It should be 10 digits.")}r=false}else{var g=e.byId("numberInput");if(g){g.setValueState(sap.ui.core.ValueState.None)}}}if(!r){return}if(r){if(i.relatedParty.getText()==="Yes"){i.relatedParty=true}else{i.relatedParty=false}var y={DigressionVendorCodeVal:i.validity,IsRelPartyVCode:i.relatedParty,SpendType:i.supplierSpendType,NatureOfActivity:i.natureOfActivity,Sector:i.sector,FunAndSubfun:i.FunctionandSubfunction,PANCardNo:i.panCardNumber,GSTIN:i.gstinNumber,SFullName:i.supplierFullName,STradeNameGST:i.supplierTradeName,SAddress:i.supplierAddress,SAddressGST:i.supplierGstAddress,PriContactFName:i.primaryFirstName,PriContactLName:i.primaryLastName,PriContactEmail:i.primaryEmail,PriContactMNumber:i.primaryPhone};console.log("DATE");console.log(i.validity);a.setUseBatch(false);var e=this;a.create("/supplierReqSrv",y,{method:"POST",success:function(a){t.show("Form submitted successfully."+a.ID);console.log(a.ID);this.onUploadFile(a.ID);console.log("----------\x3eUpload");e.clearFormFields()}.bind(this),error:function(){t.show("Error while submitting the Form.")}})}else{sap.m.MessageToast.show("Please fill All The Required fields.")}},onUploadFile:function(e){const a=(e,a)=>{e.forEach(e=>{console.log("Control reached!!!");var r={Req_Supplier_ID:a,Attachment_ID:e.attachmentId,fileName:e.fileName,mediaType:e.fileType,content:e.fileContent,Doc_Type:e.Doc_Type};console.log(r);var s=this.getOwnerComponent().getModel();s.setUseBatch(false);s.create("/SReqattachmentsSrv",r,{method:"POST",success:function(e){t.show("Attachments uploaded successfully: "+e.ID)}.bind(this),error:function(){t.show("Error while Uploading the Attachments.")}})})};var r=this.getView().getModel();var s=r.getProperty("/documentFiles");console.log(s.pan);console.log(s.gst);var i=s.pan.concat(s.gst);console.log(i);console.log(`++++++++++ ${i}++++++++++`);a(i,e)},onFileUpload:function(e){var a=e.getSource();var r=a.getValue();var s=a.oFileUpload.files[0];if(r){a.setValueState(sap.ui.core.ValueState.None)}if(s){var i=s.name;var o=i.split(".").pop();var l=new FileReader;var n=this;l.onload=function(e){var r=e.target.result;console.log("Base64 File URL: ",r);var s=n.getView().getModel();var l=s.getProperty("/documentFiles")||{pan:[],gst:[],cin:[]};var u=l.pan.length+1;var d=l.gst.length+1;var p=l.cin.length+1;var c=a.getId();var m="";var g="";if(c.includes("fileUploaderPan")){m="PAN";g=u;l.pan.push({fileName:i,fileUrl:r,fileContent:r,fileType:o,Doc_Type:"PAN",attachmentId:g})}else if(c.includes("fileUploaderGst")){m="GST";g=d;l.gst.push({fileName:i,fileUrl:r,fileContent:r,fileType:o,Doc_Type:"GST",attachmentId:g})}else if(c.includes("fileUploaderCin")){m="CIN";g=p;l.cin.push({fileName:i,fileUrl:r,fileContent:r,fileType:o,Doc_Type:"CIN",attachmentId:g})}s.setProperty("/documentFiles",l);console.log("Updated /documentFiles:",s.getProperty("/documentFiles"));t.show(m+" file "+i+" uploaded successfully.");s.refresh(true)};l.readAsDataURL(s)}},formatAttachmentButtonText:function(e,t){e=e||[];return"View Attachments ("+e.length+")"},onOpenDialog:function(e){if(!this._oDialog){this._oDialog=sap.ui.xmlfragment("com.sumo.supplieronboarding.view.fragment.uploadfile",this);this.getView().addDependent(this._oDialog)}var t=this.getView().getModel();var a=t.getProperty("/documentFiles/"+e)||[];var r=new sap.ui.model.json.JSONModel({documentFiles:a});this._oDialog.setModel(r);this._oDialog.data("documentType",e);this._oDialog.open()},onCloseDialog:function(){if(this._oDialog){this._oDialog.close()}},onDownloadFile:function(e){const a=e.getSource().data("fileName");const r=this._oDialog.data("documentType");var s=this.getView().getModel();var i=s.getProperty("/documentFiles/"+r);var o=i.find(e=>e.fileName===a);console.log("Selected File: ",o);if(o&&o.fileContent){const e=this._base64ToBlob(o.fileContent);const t=document.createElement("a");t.href=URL.createObjectURL(e);t.download=a;t.click()}else{t.show("File not found or missing content.")}},onDeleteFile:function(e){const a=e.getSource().data("fileName");const r=this._oDialog.data("documentType");sap.m.MessageBox.confirm(`Are you sure you want to delete the file "${a}"?`,{onClose:function(e){if(e==="OK"){const e=this.getView().getModel();const s=e.getProperty("/documentFiles/"+r);const i=s.filter(e=>e.fileName!==a);e.setProperty("/documentFiles/"+r,i);t.show(`File "${a}" deleted successfully.`);this.onCloseDialog()}}.bind(this)})},_base64ToBlob:function(e){if(e.startsWith("data:")){e=e.split(",")[1]}console.log("Base64 String: ",e);try{const t=atob(e);const a=[];for(let e=0;e<t.length;e+=512){const r=t.slice(e,e+512);const s=new Array(r.length);for(let e=0;e<r.length;e++){s[e]=r.charCodeAt(e)}const i=new Uint8Array(s);a.push(i)}return new Blob(a,{type:"application/octet-stream"})}catch(e){console.error("Base64 decoding failed: ",e);return null}},handleLiveChange:function(e){var t=e.getSource();var a=t.getValue();if(a){t.setValueState(sap.ui.core.ValueState.None)}},handleComboBoxChange:function(e){var t=e.getSource();var a=t.getSelectedKey();if(a){t.setValueState(sap.ui.core.ValueState.None)}},handleDateChange:function(e){var t=e.getSource();var a=t.getDateValue();if(a){t.setValueState(sap.ui.core.ValueState.None)}},handleFileChange:function(e){var t=e.getSource();var a=t.getValue();if(a){t.setValueState(sap.ui.core.ValueState.None)}},handleMultiComboBoxChange:function(e){var t=e.getSource();var a=t.getSelectedItems();if(a.length>0){t.setValueState(sap.ui.core.ValueState.None)}},clearFormFields:function(){var e=this.getView();e.byId("datePicker").setDateValue(null);e.byId("radioGroup").setSelectedButton(null);e.byId("supplierSpendType").setSelectedKey("");e.byId("NatureofActivity").setSelectedKey("");e.byId("sectorComboBox").setSelectedKeys([]);e.byId("childMultiComboBox").setSelectedKeys([]);e.byId("panInput").setValue("");e.byId("fileUploaderPan").setValue("");e.byId("fileUploaderGst").setValue("");e.byId("gstinInput").setValue("");e.byId("SupplierNameInput").setValue("");e.byId("SuppliertradeNameInput").setValue("");e.byId("SupplierAddressInput").setValue("");e.byId("SupplierAddressgstInput").setValue("");e.byId("PrimaryFirstnameInput").setValue("");e.byId("PrimaryLastnameInput").setValue("");e.byId("emailInput").setValue("");e.byId("numberInput").setValue("")},onReadSector:function(){console.log("I am sector srv");var e=this;var t=this.getOwnerComponent().getModel();t.read("/SectorSrv",{success:function(t){console.log(t);var a=new sap.ui.model.json.JSONModel(t);e.getView().byId("sectorComboBox").setModel(a)},error:function(e){console.log(e)}})},onReadNatureofActivity:function(){var e=this;var t=this.getOwnerComponent().getModel();t.read("/NatureOfActivitySrv",{success:function(t){console.log(t);var a=new sap.ui.model.json.JSONModel(t);e.getView().byId("NatureofActivity").setModel(a)},error:function(e){console.log(e)}})},onReadSupplierSpendType:function(){var e=this;var t=this.getOwnerComponent().getModel();t.read("/SupplierSpendTypeSrv",{success:function(t){console.log(t);var a=new sap.ui.model.json.JSONModel(t);e.getView().byId("supplierSpendType").setModel(a)},error:function(e){console.log(e)}})},onSave:function(){var e=this.getView();var a={validity:e.byId("datePicker").getDateValue(),relatedParty:e.byId("radioGroup").getSelectedButton().getText(),supplierSpendType:e.byId("supplierSpendType").getSelectedKey(),natureOfActivity:e.byId("NatureofActivity").getSelectedKey(),sector:e.byId("sectorComboBox").getSelectedKeys().join(", "),FunctionandSubfunction:e.byId("childMultiComboBox").getSelectedKeys(),panCardNumber:e.byId("panInput").getValue(),gstinNumber:e.byId("gstinInput").getValue(),supplierFullName:e.byId("SupplierNameInput").getValue(),supplierTradeName:e.byId("SuppliertradeNameInput").getValue(),supplierAddress:e.byId("SupplierAddressInput").getValue(),supplierGstAddress:e.byId("SupplierAddressgstInput").getValue(),primaryFirstName:e.byId("PrimaryFirstnameInput").getValue(),primaryLastName:e.byId("PrimaryLastnameInput").getValue(),primaryEmail:e.byId("emailInput").getValue(),primaryPhone:e.byId("numberInput").getValue()};var r=JSON.stringify(a);localStorage.setItem("formData",r);console.log(a);t.show("Form data saved successfully in local storage.")},onReadDepartments:function(){var e=this;var t=this.getOwnerComponent().getModel();t.read("/departmentsSrv",{success:function(t){console.log("Departments Data:",t);var a=new sap.ui.model.json.JSONModel(t);e.getView().setModel(a,"departmentsModel");var r=e.getView().byId("FunctionandSubfunctionComboBox");var s=r.getItems();if(s&&s.length>0){r.setSelectedItem(s[0]);e.onDepartmentChange({getParameter:function(){return s[0]}})}},error:function(e){console.log("Error fetching departments data:",e)}})},onDepartmentChange:function(e){var t=this;var a=e.getParameter("selectedItem");console.log("Selected Item:",a);if(a){var r=a.getBindingContext("departmentsModel").getObject();console.log("Selected Department:",r);if(r.Functions&&r.Functions.length>0){console.log("Functions:",r.Functions);var s=new sap.ui.model.json.JSONModel({Functions:r.Functions});t.getView().byId("childMultiComboBox").setModel(s,"functionsModel")}else{console.log("No functions available for the selected department.")}}},onFormSave:function(){var e=this.getView();var a=this.getOwnerComponent().getModel();var r=true;var s={DigressionVendorCodeVal:"2025-09-30",IsRelPartyVCode:true,SpendType:"Indirect",NatureOfActivity:"Material",Sector:["IT","Manufacturing"],FunAndSubfun:["Finance","HR"],PANCardNo:"ABCDE1234F",GSTIN:"27ABCDE1234F1Z5",SFullName:"ABC Corp Pvt. Ltd.",STradeNameGST:"ABC Trade",SAddress:"123, Example Street, City, State",SAddressGST:"123, Example Street, City, State",PriContactFName:"Sumit",PriContactLName:"Doe",PriContactEmail:"john.doe@example.com",PriContactMNumber:"1234567890"};a.setUseBatch(false);var e=this;a.create("/SavingsupplierReqSrv",s,{method:"POST",success:function(a){t.show("Form Saved successfully."+a.ID);console.log(a.ID);this.onUploadFile(a.ID);console.log("----------\x3eUpload");e.clearFormFields()}.bind(this),error:function(){t.show("Error while submitting the Form.")}})}})});
//# sourceMappingURL=RequestForm.controller.js.map